============================= test session starts ==============================
platform darwin -- Python 3.12.3, pytest-9.0.1, pluggy-1.6.0
rootdir: /Users/bharathvarma/Desktop/rag/RAG-Tutorials
plugins: anyio-4.11.0, langsmith-0.4.43
collected 0 items / 2 errors

==================================== ERRORS ====================================
___________________ ERROR collecting tests/test_ingestion.py ___________________
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/transformers/activations_tf.py:22: in <module>
    import tf_keras as keras
E   ModuleNotFoundError: No module named 'tf_keras'

During handling of the above exception, another exception occurred:
tests/test_ingestion.py:9: in <module>
    from components.chunkers import DocumentChunker
components/__init__.py:5: in <module>
    from .loaders import DocumentLoader
components/loaders.py:10: in <module>
    from langchain_community.document_loaders import (
<frozen importlib._bootstrap>:1412: in _handle_fromlist
    ???
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/langchain_community/document_loaders/__init__.py:740: in __getattr__
    module = importlib.import_module(_module_lookup[name])
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/importlib/__init__.py:90: in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/langchain_community/document_loaders/pdf.py:28: in <module>
    from langchain_community.document_loaders.base import BaseLoader
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/langchain_community/document_loaders/base.py:1: in <module>
    from langchain_core.document_loaders import BaseBlobParser, BaseLoader
<frozen importlib._bootstrap>:1412: in _handle_fromlist
    ???
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/langchain_core/document_loaders/__init__.py:33: in __getattr__
    result = import_attr(attr_name, module_name, __spec__.parent)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/langchain_core/_import_utils.py:35: in import_attr
    module = import_module(f".{module_name}", package=package)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/importlib/__init__.py:90: in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/langchain_core/document_loaders/base.py:19: in <module>
    from langchain_text_splitters import RecursiveCharacterTextSplitter
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/langchain_text_splitters/__init__.py:38: in <module>
    from langchain_text_splitters.sentence_transformers import (
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/langchain_text_splitters/sentence_transformers.py:10: in <module>
    from sentence_transformers import SentenceTransformer
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sentence_transformers/__init__.py:15: in <module>
    from sentence_transformers.cross_encoder import (
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sentence_transformers/cross_encoder/__init__.py:3: in <module>
    from .CrossEncoder import CrossEncoder
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sentence_transformers/cross_encoder/CrossEncoder.py:29: in <module>
    from sentence_transformers.cross_encoder.fit_mixin import FitMixin
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sentence_transformers/cross_encoder/fit_mixin.py:19: in <module>
    from sentence_transformers.datasets.NoDuplicatesDataLoader import NoDuplicatesDataLoader
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sentence_transformers/datasets/__init__.py:13: in <module>
    from .ParallelSentencesDataset import ParallelSentencesDataset
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sentence_transformers/datasets/ParallelSentencesDataset.py:19: in <module>
    from sentence_transformers import SentenceTransformer
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sentence_transformers/SentenceTransformer.py:36: in <module>
    from sentence_transformers.model_card import SentenceTransformerModelCardData, generate_model_card
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sentence_transformers/model_card.py:26: in <module>
    from transformers.integrations import CodeCarbonCallback
<frozen importlib._bootstrap>:1412: in _handle_fromlist
    ???
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/transformers/utils/import_utils.py:2317: in __getattr__
    module = self._get_module(self._class_to_module[name])
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/transformers/utils/import_utils.py:2347: in _get_module
    raise e
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/transformers/utils/import_utils.py:2345: in _get_module
    return importlib.import_module("." + module_name, self.__name__)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/importlib/__init__.py:90: in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/transformers/integrations/integration_utils.py:60: in <module>
    from .. import TFPreTrainedModel
<frozen importlib._bootstrap>:1412: in _handle_fromlist
    ???
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/transformers/utils/import_utils.py:2317: in __getattr__
    module = self._get_module(self._class_to_module[name])
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/transformers/utils/import_utils.py:2347: in _get_module
    raise e
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/transformers/utils/import_utils.py:2345: in _get_module
    return importlib.import_module("." + module_name, self.__name__)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/importlib/__init__.py:90: in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/transformers/modeling_tf_utils.py:38: in <module>
    from .activations_tf import get_tf_activation
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/transformers/activations_tf.py:27: in <module>
    raise ValueError(
E   ValueError: Your currently installed version of Keras is Keras 3, but this is not yet supported in Transformers. Please install the backwards-compatible tf-keras package with `pip install tf-keras`.
______________________ ERROR collecting tests/test_rag.py ______________________
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/transformers/activations_tf.py:22: in <module>
    import tf_keras as keras
E   ModuleNotFoundError: No module named 'tf_keras'

During handling of the above exception, another exception occurred:
tests/test_rag.py:9: in <module>
    from generation.rag import RAGPipeline
generation/__init__.py:5: in <module>
    from .rag import RAGPipeline
generation/rag.py:12: in <module>
    from augmentation.vector_db import VectorDatabase
augmentation/__init__.py:5: in <module>
    from .vector_db import VectorDatabase
augmentation/vector_db.py:15: in <module>
    from components.embedders import EmbeddingGenerator
components/__init__.py:5: in <module>
    from .loaders import DocumentLoader
components/loaders.py:10: in <module>
    from langchain_community.document_loaders import (
<frozen importlib._bootstrap>:1412: in _handle_fromlist
    ???
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/langchain_community/document_loaders/__init__.py:740: in __getattr__
    module = importlib.import_module(_module_lookup[name])
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/importlib/__init__.py:90: in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/langchain_community/document_loaders/pdf.py:28: in <module>
    from langchain_community.document_loaders.base import BaseLoader
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/langchain_community/document_loaders/base.py:1: in <module>
    from langchain_core.document_loaders import BaseBlobParser, BaseLoader
<frozen importlib._bootstrap>:1412: in _handle_fromlist
    ???
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/langchain_core/document_loaders/__init__.py:33: in __getattr__
    result = import_attr(attr_name, module_name, __spec__.parent)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/langchain_core/_import_utils.py:35: in import_attr
    module = import_module(f".{module_name}", package=package)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/importlib/__init__.py:90: in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/langchain_core/document_loaders/base.py:19: in <module>
    from langchain_text_splitters import RecursiveCharacterTextSplitter
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/langchain_text_splitters/__init__.py:38: in <module>
    from langchain_text_splitters.sentence_transformers import (
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/langchain_text_splitters/sentence_transformers.py:10: in <module>
    from sentence_transformers import SentenceTransformer
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sentence_transformers/__init__.py:15: in <module>
    from sentence_transformers.cross_encoder import (
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sentence_transformers/cross_encoder/__init__.py:3: in <module>
    from .CrossEncoder import CrossEncoder
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sentence_transformers/cross_encoder/CrossEncoder.py:29: in <module>
    from sentence_transformers.cross_encoder.fit_mixin import FitMixin
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sentence_transformers/cross_encoder/fit_mixin.py:20: in <module>
    from sentence_transformers.datasets.SentenceLabelDataset import SentenceLabelDataset
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sentence_transformers/datasets/__init__.py:13: in <module>
    from .ParallelSentencesDataset import ParallelSentencesDataset
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sentence_transformers/datasets/ParallelSentencesDataset.py:19: in <module>
    from sentence_transformers import SentenceTransformer
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sentence_transformers/SentenceTransformer.py:36: in <module>
    from sentence_transformers.model_card import SentenceTransformerModelCardData, generate_model_card
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sentence_transformers/model_card.py:26: in <module>
    from transformers.integrations import CodeCarbonCallback
<frozen importlib._bootstrap>:1412: in _handle_fromlist
    ???
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/transformers/utils/import_utils.py:2317: in __getattr__
    module = self._get_module(self._class_to_module[name])
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/transformers/utils/import_utils.py:2347: in _get_module
    raise e
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/transformers/utils/import_utils.py:2345: in _get_module
    return importlib.import_module("." + module_name, self.__name__)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/importlib/__init__.py:90: in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/transformers/integrations/integration_utils.py:60: in <module>
    from .. import TFPreTrainedModel
<frozen importlib._bootstrap>:1412: in _handle_fromlist
    ???
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/transformers/utils/import_utils.py:2317: in __getattr__
    module = self._get_module(self._class_to_module[name])
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/transformers/utils/import_utils.py:2347: in _get_module
    raise e
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/transformers/utils/import_utils.py:2345: in _get_module
    return importlib.import_module("." + module_name, self.__name__)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/importlib/__init__.py:90: in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/transformers/modeling_tf_utils.py:38: in <module>
    from .activations_tf import get_tf_activation
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/transformers/activations_tf.py:27: in <module>
    raise ValueError(
E   ValueError: Your currently installed version of Keras is Keras 3, but this is not yet supported in Transformers. Please install the backwards-compatible tf-keras package with `pip install tf-keras`.
=============================== warnings summary ===============================
<frozen importlib._bootstrap>:488
  <frozen importlib._bootstrap>:488: DeprecationWarning: builtin type SwigPyPacked has no __module__ attribute

<frozen importlib._bootstrap>:488
  <frozen importlib._bootstrap>:488: DeprecationWarning: builtin type SwigPyObject has no __module__ attribute

<frozen importlib._bootstrap>:488
  <frozen importlib._bootstrap>:488: DeprecationWarning: builtin type swigvarlink has no __module__ attribute

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
ERROR tests/test_ingestion.py - ValueError: Your currently installed version ...
ERROR tests/test_rag.py - ValueError: Your currently installed version of Ker...
!!!!!!!!!!!!!!!!!!! Interrupted: 2 errors during collection !!!!!!!!!!!!!!!!!!!!
======================== 3 warnings, 2 errors in 11.23s ========================
